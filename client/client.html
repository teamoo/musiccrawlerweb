<head>
  <title>MusicCrawler</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
	{{> page}}
</body>

<template name="page">
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span12">
				{{#if notConnected}}
					{{> connectionLostWarning}}
				{{/if}}
				
				{{>header}}

			</div>
		</div>
		<div class="row-fluid">
			<div class="span12">
				{{#if showAccountSettingsDialog}}
				  {{> accountSettingsDialog}}
				{{/if}}
				
				{{#if showAddLinkDialog}}
				  {{> addLinkDialog}}
				{{/if}}
				
				{{#if showAddSiteDialog}}
				  {{> addSiteDialog}}
				{{/if}}
				
				{{#if showSitesDialog}}
				  {{> sitesDialog}}
				{{/if}}
				
				{{#if currentUser}}
					{{> linklist}}
				{{/if}}
			</div>
		</div>
	</div>
</template>  

<template name="connectionLostWarning">
	<script type="text/javascript">
		function closeWindow() {
			if ($.browser.opera || $.browser.mozilla) window.close(); 
			else {
					window.open('','_self','');
					window.close()
				};
		}
	</script>
	<div class="alert alert-error alert-block">
		<h4 class="error heading">Achtung!</h4>
		<p>Anscheinend hast du die Verbindung zum Server verloren. Wir versuchen dich automatisch wieder zu verbinden. Sollte dies innerhalb von 1 Minute nicht klappen, schließe bitte diese Seite und öffne sie erneut.</p>
		<p>
			<a class="btn btn-danger" href="" onclick="closeWindow()">Anwendung beenden</a>
			<a class="btn" href="#">Warten</a>
		</p>
	</div>
</template>

<template name="addsitebutton">
	<li><a tabindex="-1" href="#"><i class="icon-plus"></i> Seite hinzufügen</a></li>
</template>

<template name="showsitesbutton">
	<li><a tabindex="-1" href="#"><i class="icon-th-list"></i> Seiten anzeigen</a></li>
</template>

<template name="header">
	<div class="navbar navbar-fixed-top">
		<div class="navbar-inner">
			<a class="brand" href="#">MusicCrawler</a>
			<ul class="nav" role="navigation">
				<li class="dropdown">
                      <a id="drop1" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Links <b class="caret"></b></a>
                      <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
						{{> linkfilter_items}}
                      </ul>
                </li>
				<li class="dropdown">
                      <a id="drop2" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Seiten <b class="caret"></b></a>
                      <ul class="dropdown-menu" role="menu" aria-labelledby="drop2">
                        {{> addsitebutton}}
                        <li class="divider"></li>
                        {{> showsitesbutton}}
                      </ul>
                </li>
				<li class="divider-vertical"></li>
				{{> addlinkbutton}}
				{{> copytoclipboardbutton}}
				{{> downloadlinksbutton}}
			</ul>
			<ul class="nav pull-right">
				<li>
					<form class="navbar-search pull-right">
						<input type="text" class="search-query" placeholder="Titel, Interpret, Album...">
					</form>
				</li>
				<li class="divider-vertical"></li>
				<li>
					<div class="btn-group">
						{{> user_info}}		  
					</div>
				</li>
			</ul>
		</div>
	</div>
</template>

<template name="comment">
	<div class="span4 well">
		<form accept-charset="UTF-8" action="" method="POST">
			<textarea class="span4" id="new_comment" name="new_comment"
			placeholder="Kommentar eingeben" rows="5"></textarea>
			<button class="btn btn-info" type="submit">Posten</button>
		</form>
	</div>
</template>

<template name="linkfilter_items">
	<li><a tabindex="-1" href="#" id="1">Letzte 24 Stunden <span class="badge" id="1">{{getLinkCount}}</span></a></li>
	<li><a tabindex="-1" href="#" id="14">Letzte 14 Tage <span class="badge" id="14">{{getLinkCount}}</span></a></li>
    <li><a tabindex="-1" href="#" id="30">Letzte 30 Tage <span class="badge" id="30">{{getLinkCount}}</span></a></li>
	<li><a tabindex="-1" href="#" id="90">Letzte 90 Tage <span class="badge" id="90">{{getLinkCount}}</span></a></li>
    <li class="divider"></li>
    <li><a tabindex="-1" href="#" id="365">Letztes Jahr </a></li>
</template>

<template name="user_info">
		{{#if currentUser}}
			{{> user_loggedin}}
		{{else}}
			{{> user_loggedout}}
		{{/if}}
</template>

<template name="user_loggedin">
	{{#if loggingIn}}
		<a class="btn" href="#"><i class="icon-user"></i> Einloggen...</a>
	{{else}}
		<a class="btn" href="#" id="accountbtn" rel="popover" data-original-title="{{currentUser.profile.name}}" data-placement="bottom"><i class="icon-user"></i> {{currentUser.profile.first_name}}</a>
		<a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret"></span></a>
		<ul class="dropdown-menu pull-right">
			{{> user_accountsettings}}
			<li class="divider"></li>
			<li><a href="#" id="logout"><i class="icon-off"></i> Abmelden</a></li>
		</ul>
	{{/if}}
</template>

<template name="user_loggedout">
		<a class="btn" href="#" id="login"><i class="icon-user"></i> Login</a>
</template>

<template name="user_accountsettings">
	<li><a href="#"><i class="icon-wrench"></i> Einstellungen</a></li>
</template>

<template name="addlinkbutton">
	<a class="btn" href="#"><i class="icon-plus"></i> Link hinzufügen</a>
</template>

<template name="downloadlinksbutton">
	<a class="btn btn-primary" href="#" disabled><i class="icon-circle-arrow-down icon-white"></i> Download (via JDownloader)</a>
</template>

<template name="copytoclipboardbutton">
	<a class="btn btn" href="#" disabled><i class="icon-file"></i> Zwischenablage</a>
</template>


<template name="progressBar">
	<div class="progress progress-striped active">
		<div class="bar" style="width: 40%;"></div>
	</div>
</template>

<template name="linklist">
  <table class="table table-condensed table-striped">
	<thead>
		<th>
			{{> select_all_links}}
		</th>
		<th></th>
		<th><i class="icon-volume-up"></i></th>
		<th>Name</th>
		<th>URL</th>
		<th></th>
		<th></th>
		<th>
			{{> link_filter_status}}
		</th>
		<th>Quelle</th>
		<th>Größe</th>
		<th>Hinzugefügt</th>
		</thead>
		{{#if links}}
			<tbody>
			{{#each links}}
				{{> link}}
			{{/each}}
			</tbody>
			</table>
		{{else}}
			</table>
			<p class="lead">Für den ausgewählten Zeitraum wurden keine Links gefunden.</p>
		{{/if}}
</template>

<template name="select_all_links">
	<input type="checkbox" value="" id="select_all">
</template>

<template name="link_filter_status">
	<i class="icon-filter hand"></i> Status
</template>

<template name="link">
  <tr>
	<td>
		<input type="checkbox" value="" class="link_checkbox">
	</td>
	<td>
		<i class="icon-refresh hand"></i>
	</td>
	<td>
		{{getPlayerWidget}}
	</td>
    <td>{{name}}</td>
    <td>{{url}}</td>
	<td>
		{{#if comments}}
			{{> comment_link}}
			<div class="popover left" id="{{_id}}_comments" date-title="Kommentare" data-trigger:"hover">
				<div class="arrow"></div>
				<h3 class="popover-title">Titel</h3>
				<div class="popover-content">
					{{#each comments}}
						{{message}}
					{{/each}}
				</div>
			</div>
		{{else}}
			{{> comment_link_white}}
			<div class="popover left" id="{{_id}}">
				<div class="arrow"></div>
				<h3 class="popover-title">Titel</h3>
				<div class="popover-content">
					<p>Text...</p>
				</div>
			</div>
		{{/if}}
	</td>
	<td>
	{{> like_link}}
	{{#if likes}}{{likes}}{{else}}0{{/if}}
	</td>
	<td>
		<i class="{{getStatusIcon}}"></i>
	</td>
	<td>{{source}}</td>
	<td>{{getSizeinMB}}</td>
	<td>	{{dateFormat date format="DD. MMM YYYY"}}</td>
  </tr>
</template>

<template name="comment_link">
	<i class="icon-comment hand" id="{{_id}}"></i>
</template>

<template name="comment_link_white">
	<i class="icon-comment icon-white hand" id="{{_id}}"></i>
</template>

<template name="like_link">
	<i class="icon-thumbs-up hand" id="{{_id}}"></i>
</template>

<template name="accountSettingsDialog">
<div class="mask"> </div>
<div id="accountSettingsModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 align="center">Kontoeinstellungen</h3>
  </div>
  <div class="modal-body">
	<form class="form-horizontal">
		<span class="help-inline">IP-Adresse:</span>
		<div class="input-append">
			<span class="input-medium uneditable-input ip">{{currentUser.profile.ip}}</span>
			<button class="btn btn-link" type="button">Aktualisieren</button>
		</div>
		<span class="help-inline">Port:</span>
		<input class="input-mini port" type="text" value={{currentUser.profile.port}}>
		<label class="checkbox">
		<input class="autoupdate" type="checkbox" checked={{currentUser.profile.autoupdateip}}>
		IP-Adresse automatisch updaten?
		</label>
	</form>
  </div>
  <div class="modal-footer">
    <button class="btn cancel" data-dismiss="modal" aria-hidden="true">Schließen</button>
    <button class="btn btn-primary save">Speichern</button>
  </div>
</div>
</template>

<template name="addLinkDialog">
<div class="mask"> </div>
<div id="addLinkModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 align="center">Link hinzufügen</h3>
  </div>
  <div class="modal-body">
	<form class="form-inline">
		<div class="input-append">
			<input id="newlinkurl" class="input-xlarge linkurl" type="url" placeholder="http://www28.zippyshare.com/v/82393135/file.html" required>
			<button class="btn addlink" type="button" disabled>Hinzufügen</button>
		</div>
	</form>
  </div>
</div>
</template>

<template name="addSiteDialog">
<div class="mask"> </div>
<div id="addSiteModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel3" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 align="center">Musik-Blog hinzufügen</h3>
  </div>
  <div class="modal-body">
	<form class="form-horizontal">
		<div class="input-append">
			<span class="help-inline">URL der Seite, die wir nach Links durchsuchen sollen</span>
			<input id="newsiteurl" class="input-xlarge siteurl" type="url" placeholder="http://www.electrotechnosuperblog.com" required>
			<button class="btn btn-primary addsite" disabled>Seite hinzufügen</button>
		</div>
	</form>
  </div>
</div>
</template>

<template name="sitesDialog">
<div class="mask"> </div>
<div id="showSitesModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel3" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 align="center">Musik-Blogs</h3>
  </div>
  <div class="modal-body">
		<table class="table table-striped table-condensed">
		<thead>
			<th>Name</th>
			<th>URL</th>
			<th>Typ</th>
			<th>aktiv</th>
		</thead>
		<tbody>
			{{#each sites}}
				<tr>
					<td>{{name}}</td>
					<td>{{feedurl}}</td>
					<td>{{type}}</td>
					<td>
						{{#if active}}
							<i class="icon-ok-sign"></i>
						{{/if}}
					</td>
				</tr>
			{{/each}}
		</tbody>
		</table>
  </div>
  <div class="modal-footer">
  </div>
</div>
</template>

