{"version":3,"file":"\\packages\\pages:tests.js","sources":["pages\\lib\\pages.coffee","pages\\test\\tests.coffee","pages/client\\templates.html","pages\\client\\controllers.coffee"],"names":[],"mappings":"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","sourcesContent":["@__Pages = class Pages\n  availableSettings:\n    dataMargin: [Number, 3]\n    divWrapper: [true, false] #If defined, should be a name of the wrapper's CSS classname\n    filters: [Object, {}]\n    itemTemplate: [String, \"_pagesItemDefault\"]\n    navShowEdges: [Boolean, false] #If true, overrides navShowFirst and navShowLast\n    navShowFirst: [Boolean, true] #If true, overrides navShowEdges\n    navShowLast: [Boolean, true] #If true, overrides navShowEdges\n    resetOnReload: [Boolean, false]\n    paginationMargin: [Number, 3]\n    perPage: [Number, 10]\n    requestTimeout: [Number, 2]\n    route: [String, \"/page/\"]\n    router: [true, false] #Can be any type. Use only in comparisons. Expects String or Boolean\n    routerTemplate: [String, \"pages\"]\n    sort: [Object, {}]\n    fields: [Object, {}]\n  #The following settings are unavailable to the client after initialization\n  fastRender: false\n  infinite: false\n  infiniteItemsLimit: 30\n  infiniteTrigger: .8\n  infiniteRateLimit: 1\n  pageSizeLimit: 60\n  rateLimit: 1\n  homeRoute: \"/\"\n  pageTemplate: \"_pagesPageCont\"\n  navTemplate: \"_pagesNavCont\"\n  table: false\n  tableItemTemplate: \"_pagesTableItem\"\n  tableTemplate: \"_pagesTable\"\n  templateName: false #Defaults to collection name\n  _ninstances: 0\n  _currentPage: 1\n  collections: {}\n  instances: {}\n  subscriptions: []\n  currentSubscription: null\n  methods:\n    \"CountPages\": ->\n      Math.ceil @Collection.find(@filters, \n        sort: @sort\n      ).count() / @perPage\n    \"Set\": (k, v = undefined) ->\n      if v?\n        changes = @set k, v, false, true\n      else\n        changes = 0\n        for _k, _v of k\n          changes += @set _k, _v, false, true\n      changes\n    \"Unsubscribe\": ->\n      while @subscriptions.length\n        i = @subscriptions.shift()\n        continue  unless i?\n        i.stop()\n  constructor: (collection, settings) ->\n    unless @ instanceof Meteor.Pagination\n      throw \"Please use the `new` constructor style \" + (new Error).stack.split(\"\\n\")[2].trim()\n    @setCollection collection\n    @setDefaults()\n    @applySettings settings\n    @setRouter()\n    @[(if Meteor.isServer then \"server\" else \"client\") + \"Init\"]()\n    @registerInstance()\n    @\n  serverInit: ->\n    @setMethods()\n    self = @\n    Meteor.publish @name, (page) ->\n      self.publish.call self, page, @\n  clientInit: ->\n    @requested = []\n    @received = []\n    @queue = []\n    @setTemplates()\n    @countPages()\n    @setInfiniteTrigger()  if @infinite\n    @syncSettings ((err, changes) ->\n      @reload()  if changes > 0\n    ).bind @\n  reload: ->\n    @unsubscribe (->\n      @requested = []\n      @received = []\n      @queue = []\n      @call \"CountPages\", ((e, total) ->\n        @sess \"totalPages\", total\n        p = @currentPage()\n        p = 1  if (not p?) or @resetOnReload or p > total\n        @sess \"currentPage\", false\n        @sess \"currentPage\", p\n      ).bind @\n    ).bind @\n  unsubscribe: (cb) ->\n    @call \"Unsubscribe\", (->\n      cb()  if cb?\n    ).bind(@)\n  setDefaults: ->\n    for k, v of @availableSettings\n      @[k] = v[1]  if v[1]?\n  applySettings: (settings) ->\n    for key, value of settings\n      @set key, value, false, true\n  syncSettings: (cb) ->\n    S = {}\n    for k of @availableSettings\n      S[k] = @[k]\n    @set S, undefined, true, false, cb.bind @\n  setMethods: ->\n    nm = {}\n    for n, f of @methods\n      nm[@id + n] = f.bind @\n    @methods = nm\n    Meteor.methods @methods\n  getMethod: (name)->\n    @id + name\n  call: (method, cb) ->\n    Meteor.call @getMethod(method), cb.bind(@)\n  sess: (k, v) ->\n    k = \"#{@id}.#{k}\"\n    if v?\n      Session.set k, v\n    else\n      Session.get k\n  set: (k, v = undefined, onServer = true, init = false, cb) ->\n    if cb?\n      cb = cb.bind @\n    else\n      cb = @reload.bind @\n    if Meteor.isClient and onServer\n      Meteor.call @getMethod(\"Set\"), k, v, cb\n    if v?\n      changes = @_set k, v, init\n    else\n      changes = 0\n      for _k, _v of k\n        changes += @_set _k, _v, init\n    changes\n  _set: (k, v, init = false) ->\n    ch = 0\n    if init or k of @availableSettings\n      if @availableSettings[k]? and @availableSettings[k][0] isnt true\n        check v, @availableSettings[k][0]\n      if JSON.stringify(@[k]) != JSON.stringify(v)\n        ch = 1\n      @[k] = v\n    else\n      new Meteor.Error 400, \"Setting not available.\"\n    ch\n  setId: (name) ->\n    if @templateName\n      name = @templateName\n    if name of Pages::instances\n      n = name.match /[0-9]+$/\n      if n? \n        name = name[0 .. n[0].length] + parseInt(n) + 1\n      else\n        name = name + \"2\"\n    @id = \"pages_\" + name\n    @name = name\n  registerInstance: ->\n    Pages::_ninstances++\n    Pages::instances[@name] = @\n  setCollection: (collection) ->\n    if typeof collection is 'object'\n      Pages::collections[collection._name] = collection\n      @Collection = collection\n    else\n      isNew = true\n      try\n        @Collection = new Meteor.Collection collection\n        Pages::collections[@name] = @Collection\n      catch e\n        isNew = false\n        @Collection = Pages::collections[@name]\n        console.log @Collection instanceof Meteor.Collection\n        @Collection instanceof Meteor.Collection or throw \"The '#{collection}' collection \n        was created outside of <Meteor.Pagination>. Pass the collection object\n        instead of the collection's name to the <Meteor.Pagination> constructor.\"\n    @setId @Collection._name\n    @PaginatedCollection = new Meteor.Collection @id\n  setRouter: ->\n    if @router is \"iron-router\"\n      pr = \"#{@route}:n\"\n      t = @routerTemplate\n      self = @\n      Router.map ->\n        if self.homeRoute\n          @route \"home\",\n            path: self.homeRoute\n            template: t\n            onBeforeAction: ->\n              self.sess \"oldPage\", 1\n              self.sess \"currentPage\", 1\n        unless self.infinite\n          @route \"page\",\n            path: pr\n            template: t\n            onBeforeAction: ->\n              self.onNavClick parseInt @params.n\n        if Meteor.isServer and @fastRender\n          FastRender.route \"#{@route}:n\", (params) ->\n            Meteor.subscribe @name, page\n          \n  setPerPage: ->\n    @perPage = if @pageSizeLimit < @perPage then @pageSizeLimit else @perPage\n  setTemplates: ->\n    name = @templateName or @name\n    if @table and @itemTemplate is \"_pagesItemDefault\"\n      @itemTemplate = @tableItemTemplate\n    for i in [@navTemplate, @pageTemplate, @itemTemplate, @tableTemplate]\n      Template[i].pagesData = @\n    _.extend Template[name],\n      pagesData: @\n      pagesNav: Template[@navTemplate]\n      pages: Template[@pageTemplate]\n  countPages: ->  \n    Meteor.call @getMethod(\"CountPages\"), ((e, r) ->\n      @sess \"totalPages\", r\n    ).bind(@)\n  publish: (page, subscription) ->\n    @setPerPage()\n    skip = (page - 1) * @perPage\n    skip = 0  if skip < 0\n    init = true\n    c = @Collection.find @filters,\n      sort: @sort\n      fields: @fields\n      skip: skip\n      limit: @perPage\n    self = @\n    handle = @Collection.find().observeChanges\n      changed: ((subscription, id, fields) ->\n        try\n          subscription.changed @id, id, fields\n        catch e\n      ).bind @, subscription\n      added: ((subscription, id, fields) ->\n        try\n          subscription.added @id, id, fields  unless init\n        catch e\n      ).bind @, subscription\n      removed: ((subscription, id) ->\n        try\n          subscription.removed @id, id\n        catch e\n      ).bind @, subscription\n    init = false\n    n = 0\n    c.forEach ((doc, index, cursor) ->\n      n++\n      doc[\"_#{@id}_p\"] = page\n      doc[\"_#{@id}_i\"] = index\n      subscription.added @id, doc._id, doc\n    ).bind @\n    subscription.onStop ->\n      handle.stop()\n    @ready()\n    @subscriptions.push subscription\n    c\n  loading: (p) ->\n    if not @fastRender and p is @currentPage() and Session?\n      @sess \"ready\", false\n  now: ->\n    (new Date()).getTime()\n  log: (msg) ->\n    console.log \"#{@name} #{msg}\"\n  logRequest: (p) ->\n    @timeLastRequest = @now()\n    @loading p\n    @requested.push p  unless p in @requested\n  logResponse: (p) ->\n    @received.push p  unless p in @received\n  clearQueue: ->\n    @queue = []\n  neighbors: (page) ->\n    @n = [page]\n    if @dataMargin is 0\n      return @n\n    for d in [1 .. @dataMargin]\n      np = page + d\n      if np <= @sess \"totalPages\"\n        @n.push np\n      pp = page - d\n      if pp > 0\n        @n.push pp\n    @n\n  paginationNavItem: (label, page, disabled, active = false) ->\n    p: label\n    n: page\n    active: if active then \"active\" else \"\"\n    disabled: if disabled then \"disabled\" else \"\"\n  paginationNeighbors: ->\n    page = @currentPage()\n    total = @sess \"totalPages\"\n    from = page - @paginationMargin\n    to = page + @paginationMargin\n    if from < 1\n        to += 1 - from\n        from = 1\n    if to > total\n        from -= to - total\n        to = total\n    from = 1 if from < 1\n    to = total if to > total\n    n = []\n    if @navShowFirst or @navShowEdges\n      n.push @paginationNavItem \"«\", 1, page == 1\n    n.push @paginationNavItem \"<\", page - 1, page == 1\n    for p in [from .. to]\n      n.push @paginationNavItem p, p, page > total, p is page\n    n.push @paginationNavItem \">\", page + 1, page >= total\n    if @navShowLast or @navShowEdges\n      n.push @paginationNavItem \"»\", total, page >= total\n    for i, k in n\n      n[k]['_p'] = @\n    n\n  onNavClick: (n) ->\n    if n <= @sess(\"totalPages\") and n > 0\n      Deps.nonreactive (->\n        @sess \"oldPage\", @sess \"currentPage\"\n      ).bind @\n      @sess \"currentPage\", n\n  setInfiniteTrigger: ->\n    window.onscroll = (_.throttle ->\n      t = @infiniteTrigger\n      oh = document.body.offsetHeight\n      if t > 1\n        l = oh - t\n      else if t > 0\n        l = oh * t\n      else\n        return\n      if (window.innerHeight + window.scrollY) >= l\n        if @lastPage < @sess \"totalPages\"\n          @sess(\"currentPage\", @lastPage + 1)\n    , @infiniteRateLimit * 1000\n    ).bind @\n  checkQueue: ->\n    if @queue.length\n      i = @queue.shift() until i in @neighbors(@currentPage()) or not @queue.length\n      @requestPage i  if i in @neighbors @currentPage()\n  currentPage: ->\n    if Meteor.isClient and @sess(\"currentPage\")?\n      @sess \"currentPage\"\n    else\n      @_currentPage\n  isReady: ->\n    @sess \"ready\"\n  ready: (p) ->\n    if p == true or p is @currentPage() and Session?\n      @sess \"ready\", true\n\n  getPage: (page) ->\n    if Meteor.isClient\n      page = @currentPage()  unless page?\n      page = parseInt page\n      return  if page is NaN\n      total = @sess \"totalPages\"\n      return @ready true  if total is 0\n      if page <= total\n        for p in @neighbors page\n          @requestPage p  unless p in @received\n      if @infinite\n        n = @PaginatedCollection.find({},\n          fields: @fields\n          sort: @sort\n        ).count()\n        c = @PaginatedCollection.find({},\n          fields: @fields\n          sort: @sort\n          skip: if @infiniteItemsLimit isnt Infinity and n > @infiniteItemsLimit then n - @infiniteItemsLimit else 0\n          limit: @infiniteItemsLimit\n        ).fetch()\n      else #if page in @received\n        c = @PaginatedCollection.find(\n          _.object([\n            [\"_#{@id}_p\", page]\n          ]),\n          fields: @fields\n          #sort: @sort\n        ).fetch()\n      c\n  requestPage: (page) ->\n    return  if page in @requested\n    @clearQueue()  if page is @currentPage()\n    @queue.push page\n    @logRequest page\n    Meteor.defer ((page) ->\n      @subscriptions[page] = Meteor.subscribe @name, page,\n        onReady: ((page) ->\n          @onPage page\n        ).bind @, page\n        onError: ((e) ->\n          new Meteor.Error e.message\n        ).bind @\n    ).bind @, page\n  onPage: (page) ->\n    @logResponse page\n    @ready page\n    if @infinite\n      @lastPage = page\n    @checkQueue()\n\nMeteor.Pagination = Pages\n",null,"\nTemplate.__define__(\"pages\", (function() {\n  var self = this;\n  var template = this;\n  return \"\";\n}));\n\nTemplate.__define__(\"pagesNav\", (function() {\n  var self = this;\n  var template = this;\n  return \"\";\n}));\n\nTemplate.__define__(\"_pagesLoading\", (function() {\n  var self = this;\n  var template = this;\n  return HTML.Raw('<div class=\"pagesLoadingDefaultCont\">\\n    <div class=\"pagesLoadingDefault\"><img src=\"/packages/pages/public/loader.gif\"></div>\\n  </div>');\n}));\n\nTemplate.__define__(\"_pagesPageCont\", (function() {\n  var self = this;\n  var template = this;\n  return UI.If(function() {\n    return Spacebars.dataMustache(self.lookup(\"divWrapper\"), self.lookup(\"pagesData\"));\n  }, UI.block(function() {\n    var self = this;\n    return [ \"\\n    \", HTML.DIV({\n      \"class\": function() {\n        return Spacebars.mustache(self.lookup(\"divWrapper\"), self.lookup(\"pagesData\"));\n      }\n    }, \"\\n      \", Spacebars.TemplateWith(function() {\n      return Spacebars.call(self.lookup(\"pagesData\"));\n    }, UI.block(function() {\n      var self = this;\n      return Spacebars.include(self.lookupTemplate(\"_pagesPage\"));\n    })), \"\\n    \"), \"\\n  \" ];\n  }), UI.block(function() {\n    var self = this;\n    return [ UI.If(function() {\n      return Spacebars.dataMustache(self.lookup(\"table\"), self.lookup(\"pagesData\"));\n    }, UI.block(function() {\n      var self = this;\n      return [ \"\\n    \", UI.If(function() {\n        return Spacebars.dataMustache(self.lookup(\"tableWrapper\"), self.lookup(\"pagesData\"));\n      }, UI.block(function() {\n        var self = this;\n        return [ \"\\n      \", HTML.DIV({\n          \"class\": function() {\n            return Spacebars.mustache(self.lookup(\"tableWrapper\"), self.lookup(\"pagesData\"));\n          }\n        }, \"\\n        \", Spacebars.TemplateWith(function() {\n          return Spacebars.call(self.lookup(\"pagesData\"));\n        }, UI.block(function() {\n          var self = this;\n          return Spacebars.include(self.lookupTemplate(\"_pagesTable\"));\n        })), \"\\n      \"), \"\\n    \" ];\n      }), UI.block(function() {\n        var self = this;\n        return [ \"\\n        \", Spacebars.TemplateWith(function() {\n          return Spacebars.call(self.lookup(\"pagesData\"));\n        }, UI.block(function() {\n          var self = this;\n          return Spacebars.include(self.lookupTemplate(\"_pagesTable\"));\n        })), \"\\n    \" ];\n      })), \"\\n  \" ];\n    }), UI.block(function() {\n      var self = this;\n      return [ \"\\n  \", Spacebars.TemplateWith(function() {\n        return Spacebars.call(self.lookup(\"pagesData\"));\n      }, UI.block(function() {\n        var self = this;\n        return Spacebars.include(self.lookupTemplate(\"_pagesPage\"));\n      })), \"\\n  \" ];\n    })), \"\\n  \" ];\n  }));\n}));\n\nTemplate.__define__(\"_pagesTable\", (function() {\n  var self = this;\n  var template = this;\n  return HTML.TABLE({\n    \"class\": function() {\n      return Spacebars.mustache(self.lookup(\"class\"), self.lookup(\"pagesData\"));\n    }\n  }, \"\\n    \", HTML.THEAD(\"\\n      \", HTML.TR(\"\\n        \", UI.Each(function() {\n    return Spacebars.dataMustache(self.lookup(\"header\"), self.lookup(\"pagesData\"));\n  }, UI.block(function() {\n    var self = this;\n    return [ \"\\n          \", HTML.TH(function() {\n      return Spacebars.mustache(self.lookup(\"value\"));\n    }), \"\\n        \" ];\n  })), \"\\n      \"), \"\\n    \"), \"\\n    \", HTML.TBODY(\"\\n      \", Spacebars.TemplateWith(function() {\n    return Spacebars.call(self.lookup(\"pagesData\"));\n  }, UI.block(function() {\n    var self = this;\n    return Spacebars.include(self.lookupTemplate(\"_pagesPage\"));\n  })), \"\\n    \"), \"\\n  \");\n}));\n\nTemplate.__define__(\"_pagesTableItem\", (function() {\n  var self = this;\n  var template = this;\n  return HTML.TR(\"\\n    \", UI.Each(function() {\n    return Spacebars.dataMustache(self.lookup(\"attrs\"), self.lookup(\"pagesData\"));\n  }, UI.block(function() {\n    var self = this;\n    return [ \"\\n      \", HTML.TD(function() {\n      return Spacebars.mustache(self.lookup(\"value\"));\n    }), \"\\n    \" ];\n  })), \"\\n  \");\n}));\n\nTemplate.__define__(\"_pagesPage\", (function() {\n  var self = this;\n  var template = this;\n  return [ UI.If(function() {\n    return Spacebars.call(self.lookup(\"ready\"));\n  }, UI.block(function() {\n    var self = this;\n    return \"\\n  \";\n  }), UI.block(function() {\n    var self = this;\n    return [ \"\\n    \", Spacebars.include(self.lookupTemplate(\"_pagesLoading\")), \"\\n  \" ];\n  })), \"\\n  \", UI.Each(function() {\n    return Spacebars.call(self.lookup(\"items\"));\n  }, UI.block(function() {\n    var self = this;\n    return [ \"\\n    \", Spacebars.include(self.lookupTemplate(\"item\")), \"\\n  \" ];\n  })) ];\n}));\n\nTemplate.__define__(\"_pagesNavCont\", (function() {\n  var self = this;\n  var template = this;\n  return Spacebars.TemplateWith(function() {\n    return Spacebars.call(self.lookup(\"pagesData\"));\n  }, UI.block(function() {\n    var self = this;\n    return Spacebars.include(self.lookupTemplate(\"_pagesNav\"));\n  }));\n}));\n\nTemplate.__define__(\"_pagesNav\", (function() {\n  var self = this;\n  var template = this;\n  return UI.If(function() {\n    return Spacebars.call(self.lookup(\"show\"));\n  }, UI.block(function() {\n    var self = this;\n    return [ \"\\n    \", HTML.DIV({\n      style: \"text-align:center\",\n      \"data-pages\": function() {\n        return Spacebars.mustache(self.lookup(\"name\"));\n      },\n      \"class\": \"pagination-cont\"\n    }, \"\\n      \", HTML.UL({\n      \"class\": \"pagination\"\n    }, \"\\n      \", UI.Each(function() {\n      return Spacebars.call(self.lookup(\"paginationNeighbors\"));\n    }, UI.block(function() {\n      var self = this;\n      return [ \"\\n        \", HTML.LI({\n        \"class\": [ function() {\n          return Spacebars.mustache(self.lookup(\"active\"));\n        }, \" \", function() {\n          return Spacebars.mustache(self.lookup(\"disabled\"));\n        } ]\n      }, \"\\n          \", HTML.A({\n        href: function() {\n          return Spacebars.mustache(self.lookup(\"link\"));\n        }\n      }, function() {\n        return Spacebars.mustache(self.lookup(\"p\"));\n      }), \"\\n        \"), \"\\n      \" ];\n    })), \"\\n      \"), \"\\n    \"), \"\\n  \" ];\n  }));\n}));\n\nTemplate.__define__(\"_pagesItemDefault\", (function() {\n  var self = this;\n  var template = this;\n  return HTML.DIV({\n    \"class\": \"pagesItemDefault\"\n  }, UI.Each(function() {\n    return Spacebars.call(self.lookup(\"properties\"));\n  }, UI.block(function() {\n    var self = this;\n    return [ \"\\n    \", HTML.DIV(HTML.I(function() {\n      return Spacebars.mustache(self.lookup(\"name\"));\n    }), \": \", function() {\n      return Spacebars.mustache(self.lookup(\"value\"));\n    }) ];\n  })), \"\\n  \");\n}));\n","_.extend Template['_pagesPageCont'],\n  divWrapper: (self) ->\n    self.divWrapper\n  table: (self) ->\n    self.table\n  tableWrapper: (self) ->\n    self.table.wrapper\n\n_.extend Template['_pagesTable'],\n  class: (self) ->\n    self.table.class or \"\"\n  fields: (self) ->\n    _.map self.table.fields, (v) -> value: v\n  header: (self) ->\n    _.map (self.table.header or self.table.fields), (v) -> value: v\n\n_.extend Template['_pagesPage'],\n  ready: ->\n    return true  if @fastRender\n    @sess \"ready\"\n  items: ->\n    p = @getPage @sess (if @sess(\"ready\") then \"currentPage\" else \"oldPage\")\n    return []  unless p?\n    for i, k in p\n      p[k]['_t'] = @itemTemplate\n    p\n  item: ->\n    Template[@_t]\n\n_.extend Template['_pagesNav'],\n  show: ->\n    not @infinite and 1 < @sess \"totalPages\"\n  link: ->\n    self = @_p\n    if self.router\n      p = @n\n      p = 1 if p < 1\n      total = self.sess \"totalPages\"\n      p = total if p > total\n      return self.route + p\n    \"#\"\n  paginationNeighbors: ->\n    @sess \"currentPage\"\n    @paginationNeighbors()\n  events:\n    \"click a\": (e) ->\n      n = e.target.parentNode.parentNode.parentNode.getAttribute 'data-pages'\n      self = Meteor.Pagination::instances[n]\n      (_.throttle (e, self, n) ->\n        unless self.router\n          e.preventDefault()\n          self.onNavClick.call self, n\n      , self.rateLimit * 1000)(e, self, @n)\n\n_.extend Template['_pagesTableItem'],\n  attrs: (self) ->\n    _.map self.table.fields, ((n) ->\n      value: if @[n]? then @[n] else \"\"\n    ).bind @\n\n_.extend Template['_pagesItemDefault'],\n  properties: ->\n    _.compact _.map @, (v, k) -> if k[0] isnt \"_\" then name: k, value: v else null"]}