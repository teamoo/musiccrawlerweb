<head>
  <title>MusicCrawler</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
	{{> page}}
</body>

<template name="page">
  {{#if notConnected}}
	{{> connectionLostWarning}}
  {{/if}}
  
  {{>header}}
  
  {{#if showAccountSettingsDialog}}
    {{> accountSettingsDialog}}
  {{/if}}
  
  {{#if showAddLinkDialog}}
    {{> addLinkDialog}}
  {{/if}}
  
  {{#if showAddSiteDialog}}
    {{> addSiteDialog}}
  {{/if}}
  
  {{#if showSitesDialog}}
    {{> sitesDialog}}
  {{/if}}
  
  {{> linklist}}
</template>  

<template name="connectionLostWarning">
	<script type="text/javascript">
		function closeWindow() {
			if ($.browser.opera || $.browser.mozilla) window.close(); 
			else {
					window.open('','_self','');
					window.close()
				};
		}
	</script>
	<div class="alert alert-error alert-block">
		<h4 class="error heading">Achtung!</h4>
		<p>Anscheinend hast du die Verbindung zum Server verloren. Wir versuchen dich automatisch wieder zu verbinden. Sollte dies innerhalb von 1 Minute nicht klappen, schließe bitte diese Seite und öffne sie erneut.</p>
		<p>
			<a class="btn btn-danger" href="" onclick="closeWindow()">Anwendung beenden</a>
			<a class="btn" href="#">Warten</a>
		</p>
	</div>
</template>

<template name="header">
	<div class="navbar">
		<div class="navbar-inner">
			<a class="brand" href="#">MusicCrawler</a>
			<ul class="nav" role="navigation">
				<li class="dropdown">
                      <a id="drop1" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Links <b class="caret"></b></a>
                      <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                        <li><a tabindex="-1" href="#">Heute</a></li>
                        <li><a tabindex="-1" href="#">Letzte 14 Tage</a></li>
                        <li><a tabindex="-1" href="#">Letzte 30 Tage</a></li>
						<li><a tabindex="-1" href="#">Letzte 90 Tage</a></li>
                        <li class="divider"></li>
                        <li><a tabindex="-1" href="#">Letztes Jahr</a></li>
						<li><a tabindex="-1" href="#">Alle</a></li>
                      </ul>
                </li>
				<li class="dropdown">
                      <a id="drop2" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Seiten <b class="caret"></b></a>
                      <ul class="dropdown-menu" role="menu" aria-labelledby="drop2">
                        <li><a tabindex="-1" href="#">Seite hinzufügen</a></li>
                        <li class="divider"></li>
                        <li><a tabindex="-1" href="#">Seiten anzeigen</a></li>
                      </ul>
                </li>
				<li class="divider-vertical"></li>
				{{> addlinkbutton}}
				{{> copytoclipboardbutton}}
				{{> downloadlinksbutton}}
			</ul>
			<ul class="nav pull-right">
				<li>
					<form class="navbar-search pull-right">
						<input type="text" class="search-query" placeholder="Titel, Interpret, Album...">
					</form>
				</li>
				<li class="divider-vertical"></li>
				<li>
					<div class="btn-group">
						{{> user_info}}		  
					</div>
				</li>
			</ul>
		</div>
	</div>
</template>

<template name="user_info">
		{{#if currentUser}}
			{{> user_loggedin}}
		{{else}}
			{{> user_loggedout}}
		{{/if}}
</template>

<template name="user_loggedin">
	{{#if loggingIn}}
		<a class="btn" href="#"><i class="icon-user"></i> Einloggen...</a>
	{{else}}
		<a class="btn" href="#" id="accountbtn" rel="popover" data-original-title="{{currentUser.profile.name}}" data-placement="bottom"><i class="icon-user"></i> {{currentUser.profile.first_name}}</a>
		<a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret"></span></a>
		<ul class="dropdown-menu pull-right">
			{{> user_accountsettings}}
			<li class="divider"></li>
			<li><a href="#" id="logout"><i class="icon-off"></i> Abmelden</a></li>
		</ul>
	{{/if}}
</template>

<template name="user_loggedout">
		<a class="btn" href="#" id="login"><i class="icon-user"></i> Login</a>
</template>

<template name="user_accountsettings">
	<li><a href="#"><i class="icon-wrench"></i> Einstellungen</a></li>
</template>

<template name="addlinkbutton">
	<a class="btn" href="#"><i class="icon-plus"></i> Link hinzufügen</a>
</template>

<template name="downloadlinksbutton">
	<a class="btn btn-primary" href="#" disabled><i class="icon-circle-arrow-down icon-white"></i> Download (via JDownloader)</a>
</template>

<template name="copytoclipboardbutton">
	<a class="btn btn" href="#" disabled><i class="icon-file"></i> Zwischenablage</a>
</template>


<template name="progressBar">
	<div class="progress progress-striped active">
		<div class="bar" style="width: 40%;"></div>
	</div>
</template>

<template name="linklist">
  <table class="table table-condensed table-striped">
	<thead>
		<th>
			<input type="checkbox" value="">
		</th>
		<th></th>
		<th><i class="icon-volume-up"></i></th>
		<th>Name</th>
		<th>URL</th>
		<th></th>
		<th>Status</th>
		<th>Quelle</th>
		<th>Größe</th>
		<th>Hinzugefügt</th>
	</thead>
	<tbody>
		{{#each links}}
			{{> link}}
		{{/each}}
	</tbody>
  </table>
</template>

<template name="link">
  <tr>
	<td>
		<input type="checkbox" value="">
	</td>
	<td>
		<i class="icon-refresh hand"></i>
	</td>
	<td>
		play
	</td>
    <td>{{name}}</td>
    <td>{{url}}</td>
	<td>
	<i class="icon-thumbs-up hand"></i>
	{{#if likes}}{{likes}}{{else}}0{{/if}}
	</td>
	<td>
		<i class="{{getStatusIcon}}"></i>
	</td>
	<td>{{source}}</td>
	<td>{{getSizeinMB}}</td>
	<td>{{dateFormat date format="DD. MMM YYYY"}}</td>
  </tr>
</template>

<template name="accountSettingsDialog">
<div class="mask"> </div>
<div id="accountSettingsModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 id="accountSettingsLabel" align="center">Kontoeinstellungen</h3>
  </div>
  <div class="modal-body">
	<form class="form-horizontal">
		<span class="help-inline">IP-Adresse:</span>
		<div class="input-append">
			<span class="input-medium uneditable-input ip">{{currentUser.profile.ip}}</span>
			<button class="btn btn-link" type="button">Aktualisieren</button>
		</div>
		<span class="help-inline">Port:</span>
		<input class="input-mini port" type="text" value={{currentUser.profile.port}}>
		<label class="checkbox">
		<input class="autoupdate" type="checkbox" checked={{currentUser.profile.autoupdateip}}>
		IP-Adresse automatisch updaten?
		</label>
	</form>
  </div>
  <div class="modal-footer">
    <button class="btn cancel" data-dismiss="modal" aria-hidden="true">Schließen</button>
    <button class="btn btn-primary save">Speichern</button>
  </div>
</div>
</template>

<template name="addLinkDialog">
<div class="mask"> </div>
<div id="addLinkModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 id="accountSettingsLabel" align="center">Link hinzufügen</h3>
  </div>
  <div class="modal-body">
	<form class="form-inline">
		<div class="input-append">
			<input class="input-xlarge linkurl" type="url" placeholder="http://www28.zippyshare.com/v/82393135/file.html" required>
			<button class="btn addlink" type="button">Hinzufügen</button>
		</div>
	</form>
  </div>
  <div class="modal-footer">
  </div>
</div>
</template>

<template name="addSiteDialog">
<div class="mask"> </div>
<div id="addSiteModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel3" aria-hidden="true">
  <div class="modal-header">
	<button type="button" class="close cancel" aria-hidden="true">&times;</button>
    <h3 id="accountSettingsLabel" align="center">Musik-Blog hinzufügen</h3>
  </div>
  <div class="modal-body">
	<form class="form-horizontal">
		<span class="help-inline">URL der Seite, die wir nach Links durchsuchen sollen</span>
		<input class="input-mini port" type="text" placeholder="http://electrotechnosuperblog.com">
	</form>
  </div>
  <div class="modal-footer">
    <button class="btn cancel" data-dismiss="modal" aria-hidden="true">Schließen</button>
    <button class="btn btn-primary addsite">Seite hinzufügen</button>
  </div>
</div>
</template>